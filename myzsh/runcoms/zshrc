# zmodload zsh/zprof

MYZSHDIR="${ZDOTDIR:-$HOME}/.myzsh"

if [ -d "${PROJECT_HOME}/prezto" ]; then
  ZGEN_PREZTO_REPO="${PROJECT_HOME}/prezto"
fi

zstyle ':prezto:load' pmodule-dirs "${MYZSHDIR}/modules"
source "${MYZSHDIR}/vendor/zgen/zgen.zsh"

if ! zgen saved; then
  echo "Creating a zgen save"

  ZGEN_PREZTO_LOAD_DEFAULT=0

  zgen prezto editor        key-bindings  'vi'
  zgen prezto editor        dot-expansion 'yes'
  zgen prezto prompt        theme         'monai'
  zgen prezto utility       correct       'no'
  zgen prezto utility:ls    color         'yes'
  zgen prezto utility:make  color         'yes'

  zgen prezto python:virtualenv   initialize  'no'
  zgen prezto syntax-highlighting color       'yes'

  zgen prezto

  zgen prezto environment
  zgen prezto terminal
  zgen prezto editor
  zgen prezto history
  zgen prezto directory
  zgen prezto utility
  zgen prezto completion

  zgen prezto git
  zgen prezto osx
  zgen prezto syntax-highlighting
  zgen prezto history-substring-search
  zgen prezto my-spectrum
  zgen prezto my-theme
  zgen prezto prompt
  zgen prezto fasd
  zgen prezto archive

  zgen prezto my-checks
  zgen prezto my-completion
  zgen prezto my-stub
  zgen prezto my-keybindings
  zgen prezto my-aliases
  zgen prezto my-vpn

  zgen load Tarrasch/zsh-autoenv
  zgen load "${HOME}/.zshrc.local"
  zgen load "${HOME}/.iterm2_shell_integration.zsh"

  zgen save
fi
